ret <- c(mean = m, n = n)
return(ret)
}
?rollapply
chron_long_assigned_to_scheduled_mean1 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = mean,
na.rm      = TRUE
col_rename = "mean_duration"
)
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = n,
na.rm      = TRUE
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean1 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = mean,
na.rm      = TRUE
col_rename = "mean_duration"
)
chron_long_assigned_to_scheduled_mean1 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = mean,
na.rm      = TRUE,
col_rename = "mean_duration"
)
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = n,
na.rm      = TRUE,
col_rename = "n_obs"
)
tq_transmute_fun_options()
chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = n(),
na.rm      = TRUE,
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = count,
na.rm      = TRUE,
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean1 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = mean,
na.rm      = TRUE,
col_rename = "mean_duration"
)
?count
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = tally,
na.rm      = TRUE,
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = tally,
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)
,tally_var = 1) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = tally_var,
mutate_fun = apply.monthly,
FUN        = sum,
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)
,tally_var = 1) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, tally_var, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = tally_var,
mutate_fun = apply.monthly,
FUN        = sum,
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean2
chron_long_assigned_to_scheduled_mean1
inner_join(chron_long_assigned_to_scheduled_mean1
,chron_long_assigned_to_scheduled_mean2)
chron_long_assigned_to_scheduled_mean <- inner_join(chron_long_assigned_to_scheduled_mean1
,chron_long_assigned_to_scheduled_mean2)
chron_long_assigned_to_scheduled_mean
library(magrittr)
library(highcharter)
highchart() %>%
hc_title(text = "Scatter chart with size and color") %>%
hc_add_series_scatter(mtcars$wt, mtcars$mpg,
mtcars$drat, mtcars$hp)
highchart() %>%
hc_title(text = "Scatter chart with size and color") %>%
hc_add_series_scatter(chron_long_assigned_to_scheduled_mean$dt_receipt_combo
,chron_long_assigned_to_scheduled_mean$mean_duration
,chron_long_assigned_to_scheduled_mean$n_obs
,chron_long_assigned_to_scheduled_mean$id_provider_dim_pcv)
highchart() %>%
hc_title(text = "Scatter chart with size and color") %>%
hcaes(chron_long_assigned_to_scheduled_mean$dt_receipt_combo
,chron_long_assigned_to_scheduled_mean$mean_duration
,chron_long_assigned_to_scheduled_mean$n_obs
,chron_long_assigned_to_scheduled_mean$id_provider_dim_pcv)
chron_long_assigned_to_scheduled_mean %>%
highchart() %>%
hc_title(text = "Scatter chart with size and color") %>%
hcaes(dt_receipt_combo
,mean_duration
,n_obs
,id_provider_dim_pcv)
chron_long_assigned_to_scheduled_mean %>%
highchart() %>%
hc_title(text = "Scatter chart with size and color") %>%
hcaes(x = dt_receipt_combo
,y = mean_duration
,n_obs
,id_provider_dim_pcv)
?hcaes
chron_long_assigned_to_scheduled_mean %>%
highchart() %>%
hc_add_series_times_values(dates = dt_receipt_combo
,values = mean_duration)
chron_long_assigned_to_scheduled_mean %>%
highchart()
chron_long_assigned_to_scheduled_mean
?hc_add_series_times_values
highchart() %>%
hc_add_series_times_values(dates = chron_long_assigned_to_scheduled_mean$dt_receipt_combo
,values = chron_long_assigned_to_scheduled_mean$mean_duration)
highchart("scatter") %>%
hc_add_series_times_values(dates = chron_long_assigned_to_scheduled_mean$dt_receipt_combo
,values = chron_long_assigned_to_scheduled_mean$mean_duration)
hchart(chron_long_assigned_to_scheduled_mean
,"scatter"
,hcaes(dates
,values))
hchart(chron_long_assigned_to_scheduled_mean
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration))
hchart(chron_long_assigned_to_scheduled_mean
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv))
?hcaes
hchart(chron_long_assigned_to_scheduled_mean
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean
,"scatter"
,hcaes(dt_receipt_combo %>% filter(id_provider_dim_pcv = 9)
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv = 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_theme(hc_theme_flat()) %>%
hc_add_series(type = "line", color = "#5F83EE",
fillOpacity = 0.1)
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(type = "line", color = "#5F83EE",
fillOpacity = 0.1) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(type = "loess", color = "#5F83EE",
fillOpacity = 0.1) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(type = "spline", color = "#5F83EE",
fillOpacity = 0.1) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(lm(dt_receipt_combo~mean_duration), type = "spline", color = "#5F83EE",
fillOpacity = 0.1) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(data = lm(dt_receipt_combo~mean_duration), type = "spline", color = "#5F83EE",
fillOpacity = 0.1) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(data = lm(chron_long_assigned_to_scheduled_mean$dt_receipt_combo~chron_long_assigned_to_scheduled_mean$mean_duration), type = "spline", color = "#5F83EE",
fillOpacity = 0.1) %>%
hc_add_theme(hc_theme_flat())
filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(data = list_parse2(cars), type = "scatter", regression = TRUE,
regressionSettings = list(type = "loess", loessSmooth = 2)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(type = "scatter", regression = TRUE,
regressionSettings = list(type = "loess", loessSmooth = 2)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,regressionSettings = list(type = "polynomial", order = 5, hideInLegend = TRUE)
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(chron_long_assigned_to_scheduled_meantype = "scatter", regression = TRUE,
regressionSettings = list(type = "loess", loessSmooth = 2))
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,regressionSettings = list(type = "polynomial", order = 5, hideInLegend = TRUE)
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(chron_long_assigned_to_scheduled_meantype = "scatter", regression = TRUE,
regressionSettings = list(type = "loess", loessSmooth = 2)) %>%
hc_add_theme(hc_theme_flat()) %>%
hc_add_dependency("plugins/highcharts-regression.js")
d <- sample_n(diamonds, 500)
d
hchart(d, "point", hcaes(carat, price, group = cut),
color = "transparent",
regression = TRUE,
regressionSettings = list(type = "polynomial", order = 5, hideInLegend = TRUE))
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,regression = TRUE
,regressionSettings = list(type = "polynomial", order = 5, hideInLegend = TRUE)
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(chron_long_assigned_to_scheduled_meantype = "scatter", regression = TRUE,
regressionSettings = list(type = "loess", loessSmooth = 2)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,regression = TRUE
,regressionSettings = list(type = "polynomial", order = 5, hideInLegend = TRUE)
,color = "transparent"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(chron_long_assigned_to_scheduled_meantype = "scatter", regression = TRUE,
regressionSettings = list(type = "loess", loessSmooth = 2)) %>%
hc_add_theme(hc_theme_flat())
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(lm(mean_duration ~ dt_receipt_combo, data = chron_long_assigned_to_scheduled_mean)
, name = "Polinomial Regression")
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(data = lm(mean_duration ~ dt_receipt_combo, data = chron_long_assigned_to_scheduled_mean)
, name = "Polinomial Regression")
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(data = lm(mean_duration ~ dt_receipt_combo, data = chron_long_assigned_to_scheduled_mean)
, name = "Polinomial Regression"
,regression = TRUE) %>%
hc_add_theme(hc_theme_flat())
highchart() %>%
hc_add_series(cars, "point", hcaes(speed, dist), name = "Some points") %>%
hc_add_series(loess(dist ~ speed, data = cars, span = 0.5), name = "Loess 0.5") %>%
hc_add_series(loess(dist ~ speed, data = cars, span = 5), name = "Loess 5", color = "green") %>%
hc_add_series(loess(dist ~ speed, data = cars, span = 1), name = "Loess 1", color = "gray")
hc <- highchart() %>%
hc_add_series(cars, "point", hcaes(speed, dist))
hc %>%
hc_add_series(lm(dist ~ speed, data = cars), name = "Regression") %>%
hc_add_series(loess(dist ~ speed, data = cars), name = "Loess", color = "green")
highchart("scatter") %>%
hc_add_series_times_values(dates = chron_long_assigned_to_scheduled_mean$id_provider_dim_pcv
,values = chron_long_assigned_to_scheduled_mean$mean_duration)
library(highcharter)
library(dplyr)
library(viridisLite)
library(forecast)
library(treemap)
highchart("scatter") %>%
hc_add_series_times_values(dates = chron_long_assigned_to_scheduled_mean$id_provider_dim_pcv
,values = chron_long_assigned_to_scheduled_mean$mean_duration)
chron_long_assigned_to_scheduled_mean <- inner_join(chron_long_assigned_to_scheduled_mean1
,chron_long_assigned_to_scheduled_mean2)
chron_long_assigned_to_agreed <- readRDS("~/r_repos/oliveR2/data/chron_long_assigned_to_agreed.rds") #Truncated
chron_long_assigned_to_scheduled <- readRDS("~/r_repos/oliveR2/data/chron_long_assigned_to_scheduled.rds") #ok
chron_long_assigned_to_inprogress <- readRDS("~/r_repos/oliveR2/data/chron_long_assigned_to_inprogress.rds") #Ok
chron_long_created_to_agreed <- readRDS("~/r_repos/oliveR2/data/chron_long_created_to_agreed.rds") #Not Truncated, but funky
chron_long_created_to_assigned <- readRDS("~/r_repos/oliveR2/data/chron_long_created_to_assigned.rds") #OK
chron_long_created_to_received <- readRDS("~/r_repos/oliveR2/data/chron_long_created_to_received.rds") #OK
chron_long_received_to_assigned <- readRDS("~/r_repos/oliveR2/data/chron_long_received_to_assigned.rds") #OK
chron_long_reveived_to_agreed <- readRDS("~/r_repos/oliveR2/data/chron_long_received_to_agreed.rds") #Truncated
chron_long_assigned_to_scheduled_mean1 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = mean,
na.rm      = TRUE,
col_rename = "mean_duration"
)
library(lubridate)
chron_long_assigned_to_scheduled_mean1 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = mean,
na.rm      = TRUE,
col_rename = "mean_duration"
)
library(tidyquant)
chron_long_assigned_to_scheduled_mean1 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, duration, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = duration,
mutate_fun = apply.monthly,
FUN        = mean,
na.rm      = TRUE,
col_rename = "mean_duration"
)
chron_long_assigned_to_scheduled_mean2 <- chron_long_assigned_to_scheduled %>%
filter(!is.na(duration), duration < 2020, !is.na(receipt_combo)) %>%
mutate(dt_receipt_combo = ymd(receipt_combo)
,tally_var = 1) %>%
filter(year(dt_receipt_combo) < 2020) %>%
select(dt_receipt_combo, tally_var, id_provider_dim_pcv) %>%
group_by(id_provider_dim_pcv) %>%
tq_transmute(
select     = tally_var,
mutate_fun = apply.monthly,
FUN        = sum,
col_rename = "n_obs"
)
chron_long_assigned_to_scheduled_mean <- inner_join(chron_long_assigned_to_scheduled_mean1
,chron_long_assigned_to_scheduled_mean2)
colors <- c("#0416A4", "#771086", "#FC4F1E")
hchart(chron_long_assigned_to_scheduled_mean %>% filter(id_provider_dim_pcv == 9)
,"scatter"
,hcaes(dt_receipt_combo
,mean_duration
,size = n_obs
,color = id_provider_dim_pcv)) %>%
hc_add_series(data = lm(mean_duration ~ dt_receipt_combo, data = chron_long_assigned_to_scheduled_mean)
, name = "Polinomial Regression"
,regression = TRUE) %>%
hc_add_theme(hc_theme_flat())
